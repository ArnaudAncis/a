\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{ucllcode}[2016/02/07]

\RequirePackage{pgfkeys}
\RequirePackage{listings}


% Code formatting
\pgfkeys{
  /ucll/code/.cd,
  frame/.code=\lstset{frame=#1},
  font size/.code=\lstset{basicstyle={\ttfamily #1}},
  width/.initial=.8\linewidth,
  language/.code=\lstset{language=#1},
  show lines/.code=\lstset{showlines},
  title/.code=\lstset{title=#1},
}

% \code[pgfkeys]{filename}
\newcommand{\code}[2][]{
  {
    \pgfkeys{/ucll/code/.cd,#1}
    \begin{center}
      \pgfkeys{/ucll/code/width/.get=\code@width}
      \begin{minipage}{\code@width}
        \lstinputlisting{#2}
      \end{minipage}
    \end{center}
  }
}
